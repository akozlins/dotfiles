#!/bin/bash
set -euf

export HOME="$DOTFILES"
#export HTTPS_PROXY=localhost

VIVADO_CACHE="$XDG_CACHE_HOME/vivado"
mkdir -pv -- "$VIVADO_CACHE"

if [ $# -eq 1 ] ; then
    unset CDPATH
    cd "$VIVADO_CACHE" || exit 1
fi

CMD=(
    "$VIVADO_ROOTDIR/bin/vivado"
    -jvm Xmx2048m
    -nojournal -nolog
    -tempDir "$VIVADO_CACHE"
    "$@"
)

if [ $# -eq 0 ] ; then
    exec "${CMD[@]}" > /dev/null 2>&1 &
else
    exec "${CMD[@]}"
fi
