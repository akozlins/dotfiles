#!/bin/bash
set -euf

DNS=8.8.8.8
NET=$(ip route get "$DNS" | awk '{ print $5 }')
FILTER="$XDG_CONFIG_HOME/firejail/qbittorrent.net"

CMD=(
    /usr/bin/qbittorrent
    "$@"
)

CMD1=(
    firejail
    "--debug"
    "--noprofile"
    "--net=$NET"
    "--dns=$DNS"
    "--netfilter=$FILTER"
    "--join-or-start=qbittorrent"
    --
    "${CMD[@]}"
)

[ $# -gt 0 ] && exec "${CMD[@]}"
exec "${CMD[@]}" &> /dev/null &
