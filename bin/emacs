#!/bin/bash
set -euf

CMD="/usr/bin/emacs"
if [ ! -x "$CMD" ] ; then
    "$CMD"
    exit 1
fi

EMACSDIR="$XDG_CONFIG_HOME/emacs"

INIT_EL="$EMACSDIR/init.el"

CMD=("/usr/bin/emacs" --no-init-file "--load=$INIT_EL" "$@")

if [ $# -eq 0 ] ; then
    exec "${CMD[@]}" > /dev/null 2>&1 &
else
    exec "${CMD[@]}"
fi
