#!/bin/bash
set -euf

CMD="/usr/bin/emacs"
if [ ! -x "$CMD" ] ; then
    "$CMD"
    exit 1
fi

USER_EMACS_DIRECTORY="$XDG_CONFIG_HOME/emacs"

USER_INIT_FILE="$USER_EMACS_DIRECTORY/init.el"

CMD=("/usr/bin/emacs" --no-init-file "--load=$USER_INIT_FILE" "$@")

if [ $# -eq 0 ] ; then
    exec "${CMD[@]}" > /dev/null 2>&1 &
else
    exec "${CMD[@]}"
fi
